# Railway Configuration
# https://docs.railway.app/deploy/config-as-code

[build]
# Use Dockerfile (has SQLite3 pre-installed)
builder = "dockerfile"
buildCommand = "pip cache purge && pip install --no-cache-dir -r requirements.txt && python download_models.py && python manage.py collectstatic --noinput && python manage.py migrate --noinput && python manage.py rebuild_chatbot"

[deploy]
# Use entrypoint script from Dockerfile (handles PORT correctly)
# Or use Procfile if useProcfile = true
startCommand = "/app/docker-entrypoint.sh"
healthcheckPath = "/"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10
