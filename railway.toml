# Railway Configuration
# https://docs.railway.app/deploy/config-as-code

[build]
builder = "nixpacks"
buildCommand = "pip cache purge && pip install --no-cache-dir -r requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate --noinput && python manage.py rebuild_chatbot"

[deploy]
startCommand = "gunicorn university_project.wsgi --bind 0.0.0.0:$PORT --timeout 120 --workers 2 --max-requests 1000 --max-requests-jitter 50"
healthcheckPath = "/"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10

# Ensure Railway uses nixpacks.toml for apt packages
[build.nixpacksPlan]
useProcfile = false
